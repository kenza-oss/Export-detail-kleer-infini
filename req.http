# ========================================
# KleerLogistics API - Authentification
# ========================================
# Fichier de test pour toutes les requêtes d'authentification
# Usage: Ouvrir dans VS Code avec l'extension REST Client

# Configuration de base
@baseUrl = http://localhost:8000/api/v1
@contentType = application/json

# ========================================
# 1. INSCRIPTION ET CRÉATION DE COMPTE
# ========================================

### 1.1 Inscription d'un nouvel utilisateur
POST {{baseUrl}}/users/auth/register/
Content-Type: {{contentType}}

{
    "username": "testuser",
    "email": "test@example.com",
    "password": "SecurePass123!",
    "password_confirm": "SecurePass123!",
    "first_name": "John",
    "last_name": "Doe",
    "phone_number": "+213123456789",
    "role": "sender"
}

### 1.2 Inscription d'un voyageur
POST {{baseUrl}}/users/auth/register/
Content-Type: {{contentType}}

{
    "username": "traveler1",
    "email": "traveler@example.com",
    "password": "TravelerPass123!",
    "password_confirm": "TravelerPass123!",
    "first_name": "Alice",
    "last_name": "Traveler",
    "phone_number": "+213987654321",
    "role": "traveler"
}

### 1.3 Inscription utilisateur double rôle
POST {{baseUrl}}/users/auth/register/
Content-Type: {{contentType}}

{
    "username": "bothuser",
    "email": "both@example.com",
    "password": "BothPass123!",
    "password_confirm": "BothPass123!",
    "first_name": "Bob",
    "last_name": "Both",
    "phone_number": "+213555555555",
    "role": "both"
}

# ========================================
# 2. SYSTÈME OTP (One-Time Password)
# ========================================

### 2.1 Envoyer un OTP pour vérification téléphone
POST {{baseUrl}}/users/auth/otp/send/
Content-Type: {{contentType}}

{
    "phone_number": "+213123456789"
}

### 2.2 Vérifier un OTP reçu
POST {{baseUrl}}/users/auth/otp/verify/
Content-Type: {{contentType}}

{
    "phone_number": "+213123456789",
    "code": "123456"
}

### 2.3 Vérifier le statut de vérification du téléphone
GET {{baseUrl}}/users/auth/phone/status/?phone_number=+213123456789

### 2.4 Vérifier le statut de vérification du téléphone (POST)
POST {{baseUrl}}/users/auth/phone/status/
Content-Type: {{contentType}}

{
    "phone_number": "+213123456789"
}

# ========================================
# 3. CONNEXION ET AUTHENTIFICATION JWT
# ========================================

### 3.1 Connexion utilisateur (email/password)
POST {{baseUrl}}/users/auth/login/
Content-Type: {{contentType}}

{
    "email": "test@example.com",
    "password": "SecurePass123!"
}

### 3.2 Connexion utilisateur (username/password)
POST {{baseUrl}}/users/auth/login/
Content-Type: {{contentType}}

{
    "username": "testuser",
    "password": "SecurePass123!"
}

### 3.3 Connexion avec téléphone
POST {{baseUrl}}/users/auth/login/
Content-Type: {{contentType}}

{
    "phone_number": "+213123456789",
    "password": "SecurePass123!"
}

# ========================================
# 4. GESTION DES TOKENS JWT
# ========================================

### 4.1 Rafraîchir un token JWT
POST {{baseUrl}}/users/auth/token/refresh/
Content-Type: {{contentType}}

{
    "access": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjY0LCJpYXQiOjE3NTQxNjMwNjQsImp0aSI6IjMwYjU2MTJjNGNlYTRjNGE4ZTJkZWJhMzhiZmFlMzU3IiwidXNlcl9pZCI6NSwidXNlcm5hbWUiOiJ0ZXN0dXNlciIsInJvbGUiOiJzZW5kZXIiLCJpc19hZG1pbiI6ZmFsc2V9.C878OZ-mexBpH16Hw89_77oNQh6AsTnFvMqy1aSyBkM",
    "refresh": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoicmVmcmVzaCIsImV4cCI6MTc1NDI0OTQ2NCwiaWF0IjoxNzU0MTYzMDY0LCJqdGkiOiJlYmVlZDQwYzAwZTE0YTc0OWQyNThkZTliY2MwZmI0NSIsInVzZXJfaWQiOiI1In0.F8sR8w5SvmVGGKjrjaYsncyGJWg8f7WaR8zgeGuj9N0"
}

### 4.2 Rafraîchir un token JWT (endpoint alternatif)
POST {{baseUrl}}/users/auth/refresh/
Content-Type: {{contentType}}

{
    "refresh": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjMzLCJpYXQiOjE3NTQxNjMwMzMsImp0aSI6IjBiZTU0ODdkODk3ZTQxYzdiNjU1YjgwNTJjYTY0Mjc2IiwidXNlcl9pZCI6NSwidXNlcm5hbWUiOiJ0ZXN0dXNlciIsInJvbGUiOiJzZW5kZXIiLCJpc19hZG1pbiI6ZmFsc2V9.xToRQ5sk48GFNKvmprKDVjjdsdrkZVNQc_BXqbvEc1w"
}

### 4.3 Déconnexion (invalider le refresh token)
POST {{baseUrl}}/users/auth/logout/
Content-Type: {{contentType}}
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

{
    "refresh": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0"
}

# ========================================
# 5. GESTION DES MOTS DE PASSE
# ========================================

### 5.1 Changer le mot de passe (authentifié)
POST {{baseUrl}}/users/auth/password/change/
Content-Type: {{contentType}}
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

{
    "old_password": "SecurePass123!",
    "new_password": "NewSecurePass456!"
}

### 5.2 Demander une réinitialisation de mot de passe
POST {{baseUrl}}/users/auth/password/reset/
Content-Type: {{contentType}}

{
    "email": "test@example.com"
}

### 5.3 Confirmer la réinitialisation de mot de passe
POST {{baseUrl}}/users/auth/password/reset/confirm/
Content-Type: {{contentType}}

{
    "token": "reset_token_here",
    "new_password": "NewPassword123!"
}

# ========================================
# 6. PROFIL UTILISATEUR
# ========================================

### 6.1 Récupérer le profil utilisateur
GET {{baseUrl}}/users/profile/
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

### 6.2 Mettre à jour le profil utilisateur (PUT)
PUT {{baseUrl}}/users/profile/
Content-Type: {{contentType}}
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

{
    "first_name": "John",
    "last_name": "Doe",
    "phone_number": "+213123456789",
    "preferred_language": "fr"
}

### 6.3 Mettre à jour partiellement le profil (PATCH)
PATCH {{baseUrl}}/users/profile/update/
Content-Type: {{contentType}}
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

{
    "first_name": "John Updated",
    "phone_number": "+213123456789"
}

# ========================================
# 7. STATUT ET VÉRIFICATION
# ========================================

### 7.1 Récupérer le statut complet de l'utilisateur
GET {{baseUrl}}/users/status/
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

### 7.2 Récupérer le statut de vérification
GET {{baseUrl}}/users/verification-status/
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

### 7.3 Demander une vérification de documents
POST {{baseUrl}}/users/request-verification/
Content-Type: {{contentType}}
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

{
    "document_type": "passport",
    "reason": "Vérification d'identité requise"
}

# ========================================
# 8. PREFERENCES UTILISATEUR
# ========================================

### 8.1 Mettre à jour la langue préférée
PUT {{baseUrl}}/users/preferences/language/
Content-Type: {{contentType}}
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

{
    "preferred_language": "en"
}

### 8.2 Mettre à jour le taux de commission
PUT {{baseUrl}}/users/preferences/commission/
Content-Type: {{contentType}}
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

{
    "commission_rate": 15.0
}

# ========================================
# 9. ACTIVATION/DÉSACTIVATION DES RÔLES
# ========================================

### 9.1 Activer le mode expéditeur
POST {{baseUrl}}/users/activate-sender/
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

### 9.2 Activer le mode voyageur
POST {{baseUrl}}/users/activate-traveler/
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

### 9.3 Désactiver le mode expéditeur
POST {{baseUrl}}/users/deactivate-sender/
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

### 9.4 Désactiver le mode voyageur
POST {{baseUrl}}/users/deactivate-traveler/
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

# ========================================
# 10. ANALYTICS ET STATISTIQUES
# ========================================

### 10.1 Récupérer les analytics de l'utilisateur
GET {{baseUrl}}/users/analytics/
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

### 10.2 Récupérer les performances de l'utilisateur
GET {{baseUrl}}/users/performance/
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

### 10.3 Récupérer les statistiques de l'utilisateur
GET {{baseUrl}}/users/stats/
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

# ========================================
# 11. PERMISSIONS ET AUTORISATIONS
# ========================================

### 11.1 Récupérer les permissions de l'utilisateur
GET {{baseUrl}}/users/permissions/
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

# ========================================
# 12. DOCUMENTS UTILISATEUR
# ========================================

### 12.1 Lister les documents de l'utilisateur
GET {{baseUrl}}/users/documents/
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

### 12.2 Uploader un document
POST {{baseUrl}}/users/documents/upload/
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="document_type"

passport
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="document_file"; filename="passport.pdf"
Content-Type: application/pdf

< ./passport.pdf
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### 12.3 Récupérer les détails d'un document
GET {{baseUrl}}/users/documents/1/
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

### 12.4 Supprimer un document
DELETE {{baseUrl}}/users/documents/1/
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

# ========================================
# 13. RECHERCHE D'UTILISATEURS
# ========================================

### 13.1 Rechercher des utilisateurs
GET {{baseUrl}}/users/search/?q=john&role=sender
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

# ========================================
# 14. ENDPOINTS ADMIN (Nécessitent des droits admin)
# ========================================

### 14.1 Lister tous les utilisateurs (Admin)
GET {{baseUrl}}/users/admin/users/
Authorization: Bearer your_admin_access_token_here

### 14.2 Récupérer les détails d'un utilisateur (Admin)
GET {{baseUrl}}/users/admin/users/1/
Authorization: Bearer your_admin_access_token_here

### 14.3 Mettre à jour le rôle d'un utilisateur (Admin)
PATCH {{baseUrl}}/users/admin/users/1/role/
Content-Type: {{contentType}}
Authorization: Bearer your_admin_access_token_here

{
    "role": "traveler"
}

# ========================================
# 15. PORTEFEUILLE (Redirection vers payments)
# ========================================

### 15.1 Récupérer le portefeuille
GET {{baseUrl}}/users/wallet/
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

### 15.2 Effectuer un dépôt
POST {{baseUrl}}/users/wallet/deposit/
Content-Type: {{contentType}}
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

{
    "amount": 500.00,
    "payment_method": "card"
}

### 15.3 Effectuer un retrait
POST {{baseUrl}}/users/wallet/withdraw/
Content-Type: {{contentType}}
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

{
    "amount": 200.00,
    "payment_method": "bank_transfer",
    "bank_account": "1234567890"
}

### 15.4 Effectuer un transfert
POST {{baseUrl}}/users/wallet/transfer/
Content-Type: {{contentType}}
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

{
    "recipient_email": "recipient@example.com",
    "amount": 100.00,
    "description": "Paiement pour service"
}

### 15.5 Lister les transactions
GET {{baseUrl}}/users/wallet/transactions/
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0

# ========================================
# 16. TESTS D'ERREURS ET CAS LIMITES
# ========================================

### 16.1 Test de connexion avec mauvais mot de passe
POST {{baseUrl}}/users/auth/login/
Content-Type: {{contentType}}

{
    "email": "test@example.com",
    "password": "WrongPassword123!"
}

### 16.2 Test d'envoi OTP avec numéro invalide
POST {{baseUrl}}/users/auth/otp/send/
Content-Type: {{contentType}}

{
    "phone_number": "invalid_number"
}

### 16.3 Test de vérification OTP avec code invalide
POST {{baseUrl}}/users/auth/otp/verify/
Content-Type: {{contentType}}

{
    "phone_number": "+213123456789",
    "code": "000000"
}

### 16.4 Test d'accès sans authentification
GET {{baseUrl}}/users/profile/

### 16.5 Test d'accès avec token invalide
GET {{baseUrl}}/users/profile/
Authorization: Bearer invalid_token_here

# ========================================
# 17. VARIABLES POUR LES TESTS
# ========================================

# Sauvegarder le token d'accès après connexion
@authToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0
@refreshToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjMzLCJpYXQiOjE3NTQxNjMwMzMsImp0aSI6IjBiZTU0ODdkODk3ZTQxYzdiNjU1YjgwNTJjYTY0Mjc2IiwidXNlcl9pZCI6NSwidXNlcm5hbWUiOiJ0ZXN0dXNlciIsInJvbGUiOiJzZW5kZXIiLCJpc19hZG1pbiI6ZmFsc2V9.xToRQ5sk48GFNKvmprKDVjjdsdrkZVNQc_BXqbvEc1w

### 17.1 Connexion et sauvegarde du token
# @name login
POST {{baseUrl}}/users/auth/login/
Content-Type: {{contentType}}

{
    "email": "test@example.com",
    "password": "SecurePass123!"
}

### 17.2 Utiliser le token sauvegardé
GET {{baseUrl}}/users/profile/
Authorization: Bearer {{login.response.body.tokens.access}}

# ========================================
# NOTES D'UTILISATION
# ========================================

# 1. Remplacez "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjgwLCJpYXQiOjE3NTQxNjMwODAsImp0aSI6IjAyMzY3ZjMxZWU0NTRlMjBhYjQ4YmY3ZDI2Mzc0NDg0IiwidXNlcl9pZCI6IjUifQ.7ekSN1X62HW1vaU2dIMIresu-Wlm8t_qzWjquL54Bi0" par le vrai token JWT
# 2. Remplacez "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzU0MTY2NjMzLCJpYXQiOjE3NTQxNjMwMzMsImp0aSI6IjBiZTU0ODdkODk3ZTQxYzdiNjU1YjgwNTJjYTY0Mjc2IiwidXNlcl9pZCI6NSwidXNlcm5hbWUiOiJ0ZXN0dXNlciIsInJvbGUiOiJzZW5kZXIiLCJpc19hZG1pbiI6ZmFsc2V9.xToRQ5sk48GFNKvmprKDVjjdsdrkZVNQc_BXqbvEc1w" par le vrai refresh token
# 3. Remplacez "your_admin_access_token_here" par un token admin
# 4. Ajustez les données selon vos besoins de test
# 5. Utilisez l'extension REST Client dans VS Code pour exécuter ces requêtes
# 6. Les requêtes sont organisées par fonctionnalité pour faciliter les tests

# ========================================
# EXEMPLES DE RÉPONSES ATTENDUES
# ========================================

# Connexion réussie :
# {
#   "success": true,
#   "message": "Connexion réussie",
#   "tokens": {
#     "access": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
#     "refresh": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
#   },
#   "user": {
#     "id": 1,
#     "username": "testuser",
#     "email": "test@example.com",
#     "role": "sender"
#   }
# }

# OTP envoyé :
# {
#   "success": true,
#   "message": "OTP envoyé au +213123456789",
#   "expires_in": "10 minutes"
# }

# Profil utilisateur :
# {
#   "success": true,
#   "profile": {
#     "id": 1,
#     "first_name": "John",
#     "last_name": "Doe",
#     "phone_number": "+213123456789",
#     "user": {
#       "id": 1,
#       "username": "testuser",
#       "email": "test@example.com"
#     }
#   }
# }
